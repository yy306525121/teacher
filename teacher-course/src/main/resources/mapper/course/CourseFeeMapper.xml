<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.codeyang.course.mapper.CourseFeeMapper">


    <select id="selectPageList" resultType="cn.codeyang.course.dto.lessonfee.CourseFeePageRspDto">
        select t.teacher_id, teacher.name as teacher_name, t.lesson_count
        from (select teacher_id, sum(count) as lesson_count
              from t_course_fee
              where date between #{start} and #{end}
                and del_flag = 0
              group by teacher_id) t
                 left join t_teacher teacher on teacher.id = t.teacher_id and teacher.del_flag = 0
        order by teacher.create_time desc
    </select>
    <select id="selectListGroupByDate" resultType="cn.codeyang.course.dto.lessonfee.CourseFeeDetailRspDto">
        select course_fee.date, sum(course_fee.count) as count
        from t_course_fee course_fee
        where course_fee.teacher_id = #{teacherId}
          and course_fee.date between #{start} and #{end}
        group by course_fee.date
        order by course_fee.date
    </select>
</mapper>